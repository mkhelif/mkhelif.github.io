<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Marwan Khelif - GWT : Créer un service RPC</title>
  <link rel="shortcut icon" href="/blog/assets/images/favicon.ico">
  <link rel="stylesheet" href="/blog/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="My Blog" href="/rss.xml">
  <link rel="stylesheet" href="/blog/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href='/blog'> <span class="arrow">←</span> Home </a>
    

    
        
    
    <a class="cta" href="/blogfeed.xml">Subscribe</a>
</nav>

  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>GWT : Créer un service RPC</h1>
        <h2 class="headline">July 7, 2008</h2>
    </header>
    <section id="post-body">
        <p>Le framework GWT permet depuis le client JavaScript de faire des appels RPC (Remote Procedure Call ou appels de procédures distantes) au serveur GWT.</p>

<p>L&#8217;objectif est de permettre au JavaScript client d&#8217;exécuter des méthodes sur le serveur et d&#8217;en récupérer le résultat. Tout cela de façon totalement asynchrone (<strong>A</strong>jax). Les échanges entre le client et le serveur sont faites de façon asynchrone car la plupart des navigateurs n&#8217;accordent qu&#8217;un seul Thread pour exécuter le JavaScript.</p>

<!--more-->

<h3>Infrastructure RPC</h3>

<p>Pour permettre à JavaScript de faire des appels RPC il faut écrire le service côté serveur et la vue qu&#8217;en a le client. Le code d&#8217;un service RPC est séparé en deux packages : <em>fr.mkhelif.gwt.client</em> et <em>fr.mkhelif.gwt.server</em>.</p>

<p>Dans ce tutoriel nous allons créer un service <strong>Hello</strong> qui va tout simplement dire bonjour.</p>

<h5>Package client</h5>

<p>Le package client doit contenir les interfaces décrivant les méthodes du service.</p>

<pre lang="java">/**
 * @author Marwan KHELIF
 */
public interface HelloService extends RemoteService {
    public String sayHello (String name);
} // HelloService</pre>

Voilà le code du service côté client qui sera utilisé pour effectuer des appels RPC en JavaScript.

On crée alors une interface qui sera utilisé par GWT pour effectuer les appels asynchrone. Cette interface est identique à celle que l&#8217;on vient d&#8217;écrire sauf que toutes les méthodes doivent retourner **void** et posséder un dernier argument en plus.

<pre lang="java">/**
 * @author Marwan KHELIF
 */
public interface HelloServiceAsync {
    public void sayHello (String name, AsyncCallback callback);
} // HelloServiceAsync</pre>

La classe AsyncCallBack contient deux méthodes qui permettent de gérer le résultat de l&#8217;appel :

<pre>public void onSuccess (Object result)
public void onFailure (Throwable ex)
</pre>

<h5>Package server</h5>

<p>Le package server (peut être nommé différemment) contient le code des services définis dans le package client.</p>

<p>Voilà donc notre implémentation du service <strong>Hello</strong> :</p>

<pre lang="java">/**
 * @author Marwan KHELIF
 */
public class HelloServiceImpl extends RemoteServiceServlet implements HelloService {
    public String sayHello (String name) {
        return "Hello " + name + "!";
    } // sayHello ()
} // HelloService</pre>

Voilà notre service est prêt à fonctionner, il faut maintenant le rendre disponible aux clients. Pour cela il faut modifier le fichier de l&#8217;application GWT : *MyApplication.gwt.xml*

<pre lang="xml">&lt;module>
    <!-- Inherit GWT -->
    &lt;inherits name="com.google.gwt.user.User" />

    

<!-- Available Services -->
    &lt;servlet path="/hello" class="fr.mkhelif.gwt.server.HelloServiceImpl" />
&lt;/module>
</pre>

<p>Voilà notre service RPC est prêt à l&#8217;emploi.</p>

<h3>Échange de données</h3>

<p>Afin d&#8217;échanger des données entre le client (JavaScript) et le serveur (Java) il faut sérialiser les données pour qu&#8217;elles puissent transiter par le protocole HTTP. La sérialisation fournie avec GWT est différente de celle de Java.</p>

<p>Un type d&#8217;objet peut être utilisé en paramètre ou en retour d&#8217;une méthode de Service si c&#8217;est :</p>

<ol>
<li><div>
  un type primitif : int, char, byte, double, boolean&#8230;
</div></li>
<li><div>
  un objet de type : String, Date ou un wrapper de type primitif (Double, Long, Integer, Float, Boolean, &#8230;).
</div></li>
<li><div>
  un tableau d&#8217;objets sérialisables.
</div></li>
<li><div>
  une classe utilisateur qui implémente <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/1.4/com/google/gwt/user/client/rpc/IsSerializable.html" target="_blank">com.google.gwt.user.client.rpc.IsSerialisable</a> ou <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/Serializable.html" target="_blank">java.io.Serialisable</a>.
</div></li>
</ol>

<p align="justify">
  Dans notre exemple nous n&#8217;utilisons que le type String, il n&#8217;y a donc aucun problème de sérialisation.
</p>

<h3>Appel d&#8217;un service GWT</h3>

<p align="justify">
  Une fois notre service crée, il faut effectuer des appels a sa méthode <em>sayHello</em>. Pour cela il faut demander à GWT de nous donner une référence vers ce service puis on appelle la méthode.
</p>

<h5>Instanciation du service</h5>

<p align="justify">
  Pour instancier le service il suffit d&#8217;appeler :
</p>

<pre lang="java">HelloServiceAsync service = (HelloServiceAsync) GWT.create (HelloService.class);</pre>

<p align="justify">
  Le cast de HelloService vers HelloServiceAsync est toujours sûr car l&#8217;objet Proxy créé implémente l&#8217;interface asynchrone.
</p>

<h5>Association du service à l&#8217;URL</h5>

<p align="justify">
  Une fois notre service instancié il faut le lier avec le point d&#8217;entrée du service sur le serveur : <em>/hello</em>. Pour cela on effectue l&#8217;appel suivant :
</p>

<pre>((ServiceDefTarget) service).setServiceEntryPoint (GWT.getModuleBaseURL () + "/hello");</pre>

<p align="justify">
  Voilà le service est mappé avec le serveur, on peut effectuer l&#8217;appel à la méthode.
</p>

<h5>Appel d&#8217;une méthode de service</h5>

<p align="justify">
  Pour appeler la méthode du service :
</p>

<pre lang="java">service.sayHello ("Marwan KHELIF", new AsyncCallBack () {
    public void onFailure (Throwable caught) {
        // Traitement en cas d'erreur
    } // onFailure ()

    public void onSuccess (Object result) {
        // Traitement en cas de succès
        Window.alert ((String) result);
    } // onFailure ()
});</pre>

<p align="justify">
  Voilà la méthode a été appelée sur le service RPC.
</p>

<h3>Conclusion</h3>

<p>Les services RPC est l&#8217;un des points les plus importants du framework GWT. Ils permettent d&#8217;effectuer très simplement des appels au serveur en JavaScript et ainsi mettre à jour l&#8217;interface graphique grâce aux données.</p>

    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/mkhelif">
        <img class="avatar" src="/blog/assets/images/avatar.png">
        <div>
            <span class="dark">Marwan Khelif</span>
            <span></span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=/blog/gwt-crer-un-service-rpc/ - GWT : Créer un service RPC by @mkhelif"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->


<!-- Archive post list -->

    <ul id="post-list" class="archive readmore">
        <h3>Read more</h3>
        
            <li>
                <a href="/2015/welcome-to-jekyll/">Welcome to Jekyll!<aside class="dates">Jun 19</aside></a>
            </li>
        
            <li>
                <a href="/2013/welcome-to-jekyll/">Welcome to Jekyll!<aside class="dates">Nov 10</aside></a>
            </li>
        
            <li>
                <a href="/nosql-premiers-pas-avec-cassandra/">NoSQL : premiers pas avec Cassandra<aside class="dates">Oct 01</aside></a>
            </li>
        
            <li>
                <a href="/gwt-2-0-les-nouvelles-fonctionnalits/">GWT 2.0 : les nouvelles fonctionnalités<aside class="dates">Jan 14</aside></a>
            </li>
        
            <li>
                <a href="/goo-gl-le-raccourcisseur-durl-by-google/">Goo.gl : le raccourcisseur d’URL by Google<aside class="dates">Dec 15</aside></a>
            </li>
        
            <li>
                <a href="/chrome-os-premire-prsentation/">Chrome OS : première présentation<aside class="dates">Nov 19</aside></a>
            </li>
        
            <li>
                <a href="/twitter-interets-des-listes/">Twitter : intérêts des listes<aside class="dates">Oct 31</aside></a>
            </li>
        
            <li>
                <a href="/guide-doptimisation-de-vos-applications-web/">Guide d’optimisation de vos applications Web<aside class="dates">Oct 20</aside></a>
            </li>
        
            <li>
                <a href="/twitter-la-voip-disponible-grce-jajah/">Twitter : la VoIP disponible grâce à Jajah<aside class="dates">Sep 18</aside></a>
            </li>
        
            <li>
                <a href="/cinq-moyens-pour-grer-son-identit-virtuelle/">Cinq moyens pour gérer son identité virtuelle<aside class="dates">Sep 12</aside></a>
            </li>
        
            <li>
                <a href="/ruby-on-rails-dployer-une-application-sur-tomcat-avec-jruby/">Ruby on Rails : déployer une application sur Tomcat avec JRuby<aside class="dates">Sep 07</aside></a>
            </li>
        
            <li>
                <a href="/quest-ce-quun-community-manager-le-buzz-job-actuel/">Qu’est ce qu’un Community Manager, le “buzz-job” actuel ?<aside class="dates">Aug 28</aside></a>
            </li>
        
            <li>
                <a href="/tests-en-charge-dec2-gae-et-azure/">Tests en charge d’EC2, GAE et Azure<aside class="dates">Aug 21</aside></a>
            </li>
        
            <li>
                <a href="/google-vers-une-nouvelle-version-du-moteur-de-recherche/">Google : vers une nouvelle version du moteur de recherche<aside class="dates">Aug 11</aside></a>
            </li>
        
            <li>
                <a href="/chrome-des-thmes-et-de-la-synchronisation/">Chrome : des thèmes et de la synchronisation<aside class="dates">Aug 04</aside></a>
            </li>
        
            <li>
                <a href="/gwt-20-le-grand-nettoyage/">GWT 2.0 : le grand nettoyage<aside class="dates">Aug 03</aside></a>
            </li>
        
            <li>
                <a href="/google-annonce-chrome-os/">Google annonce Chrome OS<aside class="dates">Jul 08</aside></a>
            </li>
        
            <li>
                <a href="/ouverture-du-java-store/">Ouverture du Java Store<aside class="dates">Jun 03</aside></a>
            </li>
        
            <li>
                <a href="/un-fork-de-mysql-pour-contrer-oracle-2/">Un fork de MySQL pour contrer Oracle<aside class="dates">Jun 02</aside></a>
            </li>
        
            <li>
                <a href="/oracle-rachte-sun/">Oracle rachète Sun<aside class="dates">Apr 20</aside></a>
            </li>
        
            <li>
                <a href="/premire-utilisation-du-plugin-eclipse-gwt/">Première utilisation du plugin Eclipse GWT<aside class="dates">Apr 10</aside></a>
            </li>
        
            <li>
                <a href="/flex-builder-3-gratuit-pour-les-chmeurs/">Flex Builder 3 gratuit pour les chômeurs<aside class="dates">Apr 10</aside></a>
            </li>
        
            <li>
                <a href="/google-gwt-version-16-et-consorts/">Google : GWT version 1.6 et consorts<aside class="dates">Apr 08</aside></a>
            </li>
        
            <li>
                <a href="/google-lance-son-propre-fond-dinvestissements/">Google lance son propre fond d&#8217;investissements<aside class="dates">Apr 01</aside></a>
            </li>
        
            <li>
                <a href="/chrome-comment-crer-une-extension/">Chrome : comment créer une extension ?<aside class="dates">Mar 24</aside></a>
            </li>
        
            <li>
                <a href="/skype-le-codec-silk-disponible-gratuitement/">Skype : le codec SILK disponible gratuitement<aside class="dates">Mar 04</aside></a>
            </li>
        
            <li>
                <a href="/html-5-deux-nouveaux-documents/">HTML 5 : deux nouveaux documents<aside class="dates">Feb 18</aside></a>
            </li>
        
            <li>
                <a href="/java-jframe-transparentre/">Java : JFrame transparente<aside class="dates">Jan 23</aside></a>
            </li>
        
            <li>
                <a href="/gwt-16-quoi-de-neuf/">GWT 1.6 : quoi de neuf ?<aside class="dates">Dec 11</aside></a>
            </li>
        
            <li>
                <a href="/gwt-le-futur-hosted-mode/">GWT : le futur hosted mode<aside class="dates">Dec 09</aside></a>
            </li>
        
            <li>
                <a href="/authentification-ssh-par-cl-privecl-publique/">Authentification SSH par clé privée/clé publique<aside class="dates">Nov 24</aside></a>
            </li>
        
            <li>
                <a href="/gwt-librairie-open-flash-chart/">GWT : librairie Open Flash Chart<aside class="dates">Oct 23</aside></a>
            </li>
        
            <li>
                <a href="/gwt-153-amliore-le-support-dandroid/">GWT 1.5.3 : améliore le support d&#8217;Android<aside class="dates">Oct 22</aside></a>
            </li>
        
            <li>
                <a href="/gwt-16-tomcat-ou-jetty/">GWT 1.6 : Tomcat ou Jetty ?<aside class="dates">Oct 21</aside></a>
            </li>
        
            <li>
                <a href="/ria-quel-framework-choisir/">RIA : quel framework choisir?<aside class="dates">Oct 03</aside></a>
            </li>
        
            <li>
                <a href="/gwt-the-great-gwt-roundup/">GWT : &#8220;The Great GWT roundup&#8221;<aside class="dates">Oct 02</aside></a>
            </li>
        
            <li>
                <a href="/gwt-version-15-disponible/">GWT : version 1.5 disponible<aside class="dates">Sep 02</aside></a>
            </li>
        
            <li>
                <a href="/google-lancement-de-chrome/">Google : lancement de Chrome<aside class="dates">Sep 02</aside></a>
            </li>
        
            <li>
                <a href="/google-intgration-de-google-suggest/">Google : intégration de Google Suggest<aside class="dates">Aug 28</aside></a>
            </li>
        
            <li>
                <a href="/java-benchmark-jre/">Java : benchmark de la JRE<aside class="dates">Aug 05</aside></a>
            </li>
        
            <li>
                <a href="/oracle-faille-critique-dans-weblogic/">Oracle : faille critique dans WebLogic [corrigé]<aside class="dates">Jul 30</aside></a>
            </li>
        
            <li>
                <a href="/java-utilisation-de-protocol-buffers/">Java : Utilisation de Protocol Buffers<aside class="dates">Jul 29</aside></a>
            </li>
        
            <li>
                <a href="/google-lance-protocol-buffers/">Google lance Protocol Buffers<aside class="dates">Jul 10</aside></a>
            </li>
        
            <li>
                <a href="/gwt-crer-un-service-rpc/">GWT : Créer un service RPC<aside class="dates">Jul 07</aside></a>
            </li>
        
            <li>
                <a href="/gwt-introduction-au-framework/">GWT : Introduction au framework<aside class="dates">Jul 03</aside></a>
            </li>
        
            <li>
                <a href="/google-rfrencement-des-contenus-flash/">Google : référencement des contenus Flash<aside class="dates">Jul 01</aside></a>
            </li>
        
            <li>
                <a href="/apache2-systeme-de-blacklist/">Apache2 : système de blacklist<aside class="dates">Jun 23</aside></a>
            </li>
        
            <li>
                <a href="/passerelle-entre-apache-et-tomcat/">Passerelle entre Apache et Tomcat<aside class="dates">Jun 18</aside></a>
            </li>
        
            <li>
                <a href="/serveur-de-mails-multi-domaines/">Serveur de mails multi-domaines<aside class="dates">May 23</aside></a>
            </li>
        
            <li>
                <a href="/mysql-workbench/">MySQL Workbench<aside class="dates">May 02</aside></a>
            </li>
        
            <li>
                <a href="/javaone-2008/">JavaOne 2008<aside class="dates">Apr 25</aside></a>
            </li>
        
            <li>
                <a href="/nouveautes-java-7-dolphin/">Nouveautés Java 7 &#8211; Dolphin<aside class="dates">Mar 17</aside></a>
            </li>
        
            <li>
                <a href="/garbage-collector-ancienne-generation/">Garbage Collector ancienne génération<aside class="dates">Mar 15</aside></a>
            </li>
        
            <li>
                <a href="/java-sur-iphone/">Java sur iPhone<aside class="dates">Mar 10</aside></a>
            </li>
        
            <li>
                <a href="/chiffre-de-vigenere/">Chiffre de Vigénère<aside class="dates">Jan 17</aside></a>
            </li>
        
            <li>
                <a href="/chiffre-de-cesar/">Chiffre de César<aside class="dates">Jan 17</aside></a>
            </li>
        
            <li>
                <a href="/chiffre-de-beaufort/">Chiffre de Beaufort<aside class="dates">Jan 16</aside></a>
            </li>
        
            <li>
                <a href="/validation-xml/">Validation XML<aside class="dates">Jan 03</aside></a>
            </li>
        
            <li>
                <a href="/rome-telechargement-88/">ROME &#8211; Téléchargement (8/8)<aside class="dates">Jul 25</aside></a>
            </li>
        
            <li>
                <a href="/rome-integration-avec-une-servlet-78/">ROME &#8211; Intégration avec une Servlet (7/8)<aside class="dates">Jul 22</aside></a>
            </li>
        
            <li>
                <a href="/rome-ecriture-dun-flux-68/">ROME &#8211; Écriture d&#8217;un flux (6/8)<aside class="dates">Jul 21</aside></a>
            </li>
        
            <li>
                <a href="/rome-aggregation-de-plusieurs-flux-58/">ROME &#8211; Aggrégation de plusieurs flux (5/8)<aside class="dates">Jul 20</aside></a>
            </li>
        
            <li>
                <a href="/rome-conversion-dun-format-a-un-autre-48/">ROME &#8211; Conversion d&#8217;un format à un autre (4/8)<aside class="dates">Jul 19</aside></a>
            </li>
        
            <li>
                <a href="/rome-lecture-dun-flux-38/">ROME &#8211; Lecture d&#8217;un flux (3/8)<aside class="dates">Jul 18</aside></a>
            </li>
        
            <li>
                <a href="/rome-fonctionnement-28/">ROME &#8211; Fonctionnement (2/8)<aside class="dates">Jul 16</aside></a>
            </li>
        
            <li>
                <a href="/rome-presentation-18/">ROME &#8211; Présentation (1/8)<aside class="dates">Jul 15</aside></a>
            </li>
        
    </ul>





  </section>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="/blog/assets/js/main.js"></script>
  <script src="/blog/assets/js/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXXX-X', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>



