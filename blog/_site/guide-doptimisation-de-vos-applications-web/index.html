<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Guide d’optimisation de vos applications Web</title>
  <meta name="description" content="Bon ça fait un moment que je prépare cet article (j’en ai encore en préparation) mais je ne trouvai pas le temps pour finir de le rédiger. Cet article est un...">

  <link rel="stylesheet" href="/blog//css/main.css">
  <link rel="canonical" href="http://www.mkhelif.fr//blog//guide-doptimisation-de-vos-applications-web/">
  <link rel="alternate" type="application/rss+xml" title="Marwan Khelif" href="http://www.mkhelif.fr//blog//feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/blog//">Marwan Khelif</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/blog//about/">About</a>
          
        
          
        
          
        
          
          <a class="page-link" href="/blog//about/index.html">About me</a>
          
        
          
          <a class="page-link" href="/blog//projects/index.html">Projects</a>
          
        
          
          <a class="page-link" href="/blog//jsassert/index.html">jsassert</a>
          
        
          
          <a class="page-link" href="/blog//spring-social-amazon/index.html">spring-social-amazon</a>
          
        
          
          <a class="page-link" href="/blog//blog/index.html">Blog</a>
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Guide d’optimisation de vos applications Web</h1>
    <p class="post-meta">Oct 20, 2009 • mkhelif</p>
  </header>

  <article class="post-content">
    <p>Bon ça fait un moment que je prépare cet article (j’en ai encore en préparation) mais je ne trouvai pas le temps pour finir de le rédiger. Cet article est une liste de conseils  afin d’optimiser vos applications Web.</p>

<h3 id="optimisation-du-serveur">Optimisation du serveur</h3>

<p>La première chose à faire lorsque vous êtes dans une démarche d’optimisation de vos applications Web est d’optimiser au maximum le serveur qui va héberger les applications. Car vous aurez beau passer tout votre temps à optimiser vos applications, si le serveur met du temps à servir les requêtes ça n’aura servi à rien.</p>

<h4 id="serveur-priv">Serveur privé</h4>

<p>Si vous développez une application Web dans un but professionnel il est nécessaire d’avoir un serveur privé avec une adresse IP dédiée et un accès SSH. Cela permet d’avoir un accès complet à l’ensemble de la configuration du serveur et d’installer de nouveaux programmes : comment faites-vous si votre hébergement mutualisé ne contient pas l’extension cURL de PHP et que votre application ne peut être exécuté sans?</p>

<p>Si c’est une application personnelle (un blog par exemple) il est toujours bon d’avoir un accès complet à la configuration du serveur. Aujourd’hui il existe de nombreuses solutions de serveurs dédiés pour 30€ / mois ou moins.</p>

<p><strong>Bénéfices :</strong> configuration, sécurité et stabilité.</p>

<h4 id="activer-la-compression">Activer la compression</h4>

<p>Le serveur Web reçoit des requêtes et envoi en réponse des contenus (HTML, CSS, images, …). Le temps de chargement complet d’une page Web représente le temps de chargements de toutes les ressources : le client demande d’abord la page HTML puis charge au fur et à mesure toutes les ressources référencées par la page.</p>

<p>L’objectif est donc de diminuer le temps réseau du téléchargement des ressources en compressant les données envoyées par le serveur avec gZIP. Compresser les données textuelles (HTML, JavaScript, CSS) est extrêmement efficace : environ 50% de gain (donc deux fois moins de temps de téléchargement pour le client).</p>

<p>Pour Apache il faut activer le module “<em>deflate</em>” ou “<em>gzip</em>” pour les anciennes versions (jusqu’à 1.3).</p>

<p><strong>Bénéfices :</strong> gain important sur le temps de téléchargement du client.</p>

<h4 id="activer-le-cache">Activer le cache</h4>

<p>Lorsqu’un utilisateur se connecte à un serveur Web il télécharge toutes les ressources associées à la page Web qu’il consulte. Cependant sur la page, très peu de ressources ne sont modifiées au cours du temps : vous ne changez pas le logo de votre site tous les quatre matins. Quel est alors l’intérêt de forcer l’utilisateur à re-télécharger ces ressources?</p>

<p>Pour cela le protocole HTTP propose un système de cache des ressources qui permet au navigateur d’utiliser des ressources dont la version n’a pas changé. Par défaut les serveurs Web sont configurés avec le cache activé et vous n’avez donc rien à faire, mais il vaut mieux rappeler les bons conseils.</p>

<p>Pour Apache, il faut activer le module “<em>expires</em>” qui utilise l’en-tête “<em>Expires</em>” pour donner une date de péremption à la réponse, le client peut dont la mettre en cache et ainsi réduire considérablement le nombre de requêtes au serveur.</p>

<p>Pour ajouter le mode “<em>expires</em>” :</p>

<pre>a2enmod expires</pre>

<p>Ensuite vous devez modifier le fichier “<em>expires.conf</em>” pour référencer les fichiers pour lesquels vous souhaitez ajouter le header.</p>

<p><strong>Bénéfices :</strong> réduction du nombre de requêtes au serveur Web et réduction des accès disques et de temps processeur.</p>

<h4 id="amliorer-la-configuration">Améliorer la configuration</h4>

<p>Tous les serveurs Web ont une configuration par défaut : nombre de Threads maximum à démarrer, durée maximum de temps de traitement, mémoire allouée à chaque Thread, …</p>

<font color="#ff0000"><font color="#000000">Vous devez modifier la configuration afin que le serveur Web réponde au niveau de qualité souhaité. Parmi toutes les propriétés que vous pouvez configurer, voici les plus courantes :</font></font>

<ul>
  <li><strong>Désactiver le <em>reverse DNS</em></strong> <strong>:</strong> lorsqu’un client se connecte à votre application Web, sa requête est enregistrée dans les logs du serveur. Le serveur va effectuer une requête DNS afin de récupérer le nom de domaine correspondant à l’adresse IP du client. En désactivant cette option vous économiserez de nombreuses requêtes inutiles.</li>
  <li>
    <p><strong>Keep-Alive :</strong> cette option permet au serveur Web de ne pas fermer la connexion du client lorsque la requête a été servie. Cela économise de nombreuses ouvertures de connexions au client.</p>

    <p>Au niveau de cette option il y a quelques paramètres à modifier : <em>KeepAliveTimeout</em> et <em>Timeout</em>. Le paramètre <em>KeepAliveTimeout</em> représente le temps maximum entre deux requêtes sur la même connexion. Le paramètre <em>Timeout</em> représente le temps maximum entre la connexion et la première requête. Ces deux paramètres étant à modifier en fonction de votre application.</p>
  </li>
</ul>

<h3 id="optimisation-des-ressources">Optimisation des ressources</h3>

<p>Une fois que votre serveur Web est prêt avec une configuration optimale, vous pouvez optimiser les ressources que vous utilisez dans votre application : CSS, JavaScript, images.</p>

<h4 id="sprite-css">Sprite CSS</h4>

<p>Lors du chargement d’une page HTML, le navigateur Web va récupérer l’ensemble des ressources : CSS, JavaScript et souvent beaucoup d’images. Pour récupérer toutes les ressources, le navigateur utilise par défaut deux connexions au serveur Web et va attendre que l’une des connexions soit disponible pour récupérer la ressource suivante.</p>

<p>Les sprites CSS permettent de regrouper toutes ou une grande partie des images en une seule image. Il y a deux intérêts à cette technique : beaucoup moins de requêtes faîtes au serveur Web et l’image sera moins volumineuse (les informations de format et de compression ne sont stoquées qu’une seule fois).</p>

<p>Au niveau des feuilles de style CSS, il faut mettre la grande image en arrière-plan du composant et positionner le sprite (la parcelle de l’image) souhaité grâce à l’instruction <em>background-position</em>.</p>

<p>Au niveau du gain de volume de l’image voilà des statistiques :</p>

<div align="center">
  <table>
    <tr>
      <th>
        Format
      </th>
      
      <th>
        Taille six images
      </th>
      
      <th>
        Taille image sprite
      </th>
      
      <th>
        Différence
      </th>
    </tr>
    
    <tr>
      <td>
        GIF
      </td>
      
      <td>
        6046 b
      </td>
      
      <td>
        1894 b
      </td>
      
      <td>
        <font color="#1db002">-69%</font>
      </td>
    </tr>
    
    <tr>
      <td>
        JPEG
      </td>
      
      <td>
        5916 b
      </td>
      
      <td>
        2187 b
      </td>
      
      <td>
        <font color="#1db002">-63%</font>
      </td>
    </tr>
    
    <tr>
      <td>
        PNG
      </td>
      
      <td>
        4479 b
      </td>
      
      <td>
        3844 b
      </td>
      
      <td>
        <font color="#1db002">-14%</font>
      </td>
    </tr>
  </table>
</div>

<h4 id="rduction-des-css">Réduction des CSS</h4>

<p>Les feuilles de styles sont les éléments principaux du design d’une application Web et peuvent rapidement devenir des ressources volumineuses. Le principal problème des feuilles de styles est quelles contiennent énormément de caractères inutiles : espaces, sauts de lignes, commentaires. Le navigateur Web quand il reçoit une feuille de style ignore c’est caractère, ils ne sont utilisés que par le designer afin de facilement comprendre les instructions.</p>

<p>Afin d’économiser de la bande passante et du temps de téléchargement d’une page Web il est possible de réduire considérablement la taille des feuilles de styles grâce à des services Web comme : <a href="http://www.cssoptimiser.com/">CSS Optimizer</a>, <a href="http://iceyboard.no-ip.org/projects/css_compressor">Icey’s CSS Compressor</a>, <a href="http://flumpcakes.co.uk/css/optimiser/">Flumpcake CSS Optimizer</a>, <a href="http://www.cleancss.com/">Clean CSS</a>.</p>

<p>Si on regarde la différence sur certains sites avec un certain nombre de visiteurs :</p>

<div align="center">
  <table>
    <tr>
      <th>
        Site Web
      </th>
      
      <th>
        Feuille de styles
      </th>
      
      <th>
        Feuille de styles optimisée
      </th>
      
      <th>
        Différence
      </th>
    </tr>
    
    <tr>
      <td>
        Free.fr
      </td>
      
      <td>
        35.19 Kb
      </td>
      
      <td>
        19.09 Kb
      </td>
      
      <td>
        <font color="#1db002">-46%</font>
      </td>
    </tr>
    
    <tr>
      <td>
        PC Inpact
      </td>
      
      <td>
        37.14 Kb
      </td>
      
      <td>
        27.31 Kb
      </td>
      
      <td>
        <font color="#1db002">-26%</font>
      </td>
    </tr>
    
    <tr>
      <td>
        Microsoft.com
      </td>
      
      <td>
        30.7 Kb
      </td>
      
      <td>
        22.41 Kb
      </td>
      
      <td>
        <font color="#1db002">-27%</font>
      </td>
    </tr>
  </table>
</div>

<p>Oui Twitter n’est pas présent, leur feuille de styles est déjà optimisée <img src="http://www.mkhelif.fr/wp-includes/images/smilies/icon_smile.gif" alt=":)" class="wp-smiley" /> .</p>

<p>Afin d’économiser en nombre de requêtes, vous pouvez regrouper tous vos styles dans un seul fichier CSS.</p>

<h4 id="rduction-des-javascripts">Réduction des JavaScripts</h4>

<p>De la même façon que pour les feuilles de styles, les fichiers JavaScript peuvent être optimisés afin de diminuer le temps de téléchargements de ces fichiers. Voici les services Web qui proposent de réduire vos JavaScripts : <a href="http://shrinksafe.dojotoolkit.org/">Dojo Shrinksafe</a>, <a href="http://javascriptcompressor.com/">JavaScript Compressor</a><font color="#000000">. Il existe de très nombreuses applications qui font le même travaille.</font></p>

<h4 id="stockage-des-ressources">Stockage des ressources</h4>

<p>Lorsqu’un utilisateur arrive sur une page Web, il télécharge le HTML puis il récupère les ressources référencées par la page. Les ressources sont téléchargées en utilisant par défaut deux connexions par serveur. L’idée est donc de séparée le stockage des ressources statiques des données dynamiques : le HTML généré sur un serveur, les CSS et JavaScripts sur un autre serveur.</p>

<p align="center">
  <a href="http://www.mkhelif.fr/wp-content/uploads/2009/10/server.png"><img title="server" border="0" alt="server" src="http://www.mkhelif.fr/wp-content/uploads/2009/10/server.png" width="504" height="281" /></a>
</p>

<font color="#000000"><strong>Bénéfices :</strong> le client va utiliser deux connexions pour récupérer uniquement des ressources statiques et ne va pas surcharger le serveur de traitement avec des requêtes “statiques”.</font>

<h3 id="optimisation-de-lapplication">Optimisation de l’application</h3>

<p>Voilà à partir d’ici vous devez avoir bien amélioré le temps de chargement de votre application. Les conseils suivants sont plus des conseils</p>

<h4 id="landing-page">Landing page</h4>

<p>Une “landing page” est une page sur laquelle vous souhaitez que vos visiteurs arrivent depuis les moteurs de recherches et autres. L’objectif de cette page est que l’utilisateur n’arrive pas sur une page d’accueil mais directement sur l’information qu’il cherche. Il faut donc que cette page soit rapide et présente l’information de façon simple et concise.</p>

<p>Pour cela évitez au maximum d’effectuer de long traitement ou d’effectuer des appels à une base de données si ce n’est pas nécessaire. Préférez une version statique d’une landing page qui sera servie très rapidement.</p>

<h4 id="viter-les-redirections">Éviter les redirections</h4>

<p>Évitez au maximum le nombre de redirections, à chaque fois que le serveur renvoie une redirection (301, 302, …), le client effectue une nouvelle requête. Si en plus vous n’avez pas activé le <em>Keep-Alive</em>, il va faire une nouvelle connexion.</p>

<p>Ne garder les redirections que pour du SEO afin de ne pas perdre le référencement d’une page dont vous changez l’URL.</p>

<h4 id="plugins-wordpress">Plugins WordPress</h4>

<font color="#000000">Si vous utilisez WordPress il existe de nombreux plugins qui permettent d’améliorer la vitesse de chargement de votre blog.</font>

<h5 id="wp-super-cache">WP Super Cache</h5>

<font color="#000000"><a href="http://wordpress.org/extend/plugins/wp-super-cache/">WP Super Cache</a> est un plugin qui va générer une version statique de vos pages (billets, pages, …). Ainsi votre blog servira la version statique au lieu de re-générer la page HTML pour chaque visiteur. La version statique est re-générée à chaque nouveaux commentaires, billets ou pages.</font>

<h5 id="rduire-son-nombre-de-plugins">Réduire son nombre de plugins</h5>

<font color="#000000">À chaque fois qu’un utilisateur effectue une action sur un blog wordpress, le serveur appelle les plugins nécessaires pour servir la page. Si vous avez beaucoup de plugins, cela peut ralentir radicalement votre blog.</font>

<font color="#000000">Faîtes le ménage dans vos plugins et ne garder que les essentiels.</font>

<h3 id="outils-danalyse">Outils d’analyse</h3>

<p>Afin de voir les différences de temps de chargement d’une page il faut avoir de bons outils d’analyse. Que ce soit un outils spécialisé ou un module du navigateur Web, il est nécessaire de mesurer les différences entre deux configurations.</p>

<h4 id="firebug">Firebug</h4>

<p>Pour les développeurs Web qui ont l’habitude de tester leurs applications avec Firefox, la plupart utilisent le plugin Firebug qui permet entre autres d’analyser en détail (et de modifier en direct) le contenu HTML, le CSS, le JavaScript et de visualiser les requêtes/réponses avec l’application Web.</p>

<p>De nombreux plugins ont été développés sur Firebug pour fournir des informations sur le chargement de la page.</p>

<h5 id="page-speed">Page Speed</h5>

<p align="center">
  <a href="http://www.mkhelif.fr/wp-content/uploads/2009/10/pagespeed.png"><img title="pagespeed" border="0" alt="pagespeed" src="http://www.mkhelif.fr/wp-content/uploads/2009/10/pagespeed.png" width="504" height="202" /></a>
</p>

<p><a href="http://code.google.com/intl/fr/speed/page-speed/">Page Speed</a> est une extension pour Firebug, réalisée par Google, qui analyse la page Web qui vient d’être chargée et vous informe des améliorations que vous pouvez apporter à votre serveur / configuration /  application pour diminuer le temps de chargement de votre page.</p>

<h5 id="yslow">YSlow</h5>

<p align="center">
  <a href="http://www.mkhelif.fr/wp-content/uploads/2009/10/yslow.png"><img title="yslow" border="0" alt="yslow" src="http://www.mkhelif.fr/wp-content/uploads/2009/10/yslow.png" width="504" height="221" /></a>
</p>

<p><a href="http://developer.yahoo.com/yslow/">YSlow</a> a été développé par Yahoo est analyse aussi les points à améliorer.</p>

<h4 id="tests-de-charge">Tests de charge</h4>

<p>Enfin une fois que vous avez optimisé votre application Web il est bon de savoir si elle va tenir la charge face au nombre d’utilisateurs prévus. Pour cela il existe de nombreux outils de test en charge d’application Web, mais je n’en conseillerai qu’un : <a href="http://neotys.fr/test-en-charge/how-it-works.html">NeoLoad</a>, par la société <strike>où je bosse</strike> <a href="http://www.neotys.fr/">Neotys</a>.</p>

<p>L’objectif est de faire simuler par le logiciel un nombre d’utilisateurs virtuels qui vont exécuter un scénario sur l’application et d’analyser les résultats (temps de réponses, erreurs, …) afin de corriger ou d’optimiser l’application.</p>

<h3 id="conclusion">Conclusion</h3>

<p>Le secret pour avoir une application Web rapide et efficace est de tester votre configuration, d’analyser les points à améliorer et de les optimiser puis de re-tester, … et ainsi de suite jusqu’à ce que vous atteignez la qualité de service souhaitée.</p>

<p>Et vous comment faîtes vous pour optimiser vos applications Web? Quels outils utilisez-vous?</p>


  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Marwan Khelif</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Marwan Khelif</li>
          <li><a href="mailto:mkhelif@gmail.com">mkhelif@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/mkhelif">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">mkhelif</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/mkhelif">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">mkhelif</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
